---
- homebrew:
  when: ansible_os_family == 'Darwin'
  name: "rbenv, ruby-build"

- name: install ruby {{ ruby_version }}
  command: rbenv install {{ ruby_version }} creates=~/.rbenv/versions/{{ ruby_version }}
  register: ruby_installed

- name: set default ruby version to {{ ruby_version }}
  command: rbenv global {{ ruby_version }}
  when: ruby_installed.rc != 0

- gem:
    name: solargraph
    state: present
